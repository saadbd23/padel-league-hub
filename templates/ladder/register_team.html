{% extends "base.html" %}
{% block content %}
<div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  <div class="bg-white/95 backdrop-blur-lg rounded-2xl shadow-2xl p-8 md:p-12">
    <h2 class="text-4xl font-bold text-gray-900 mb-2 text-center">Ladder Tournament Registration</h2>
    <p class="text-gray-600 text-center mb-4">Register your team to join the ladder tournament</p>

    <!-- PAYMENT NOTICE - TOP -->
    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-6 rounded-r-lg">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-6 w-6 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-bold text-yellow-900 mb-2">ðŸ’³ REGISTRATION FEE REQUIRED</h3>
          <p class="text-sm text-yellow-800 leading-relaxed mb-2">
            There is a <strong>BDT 500 registration fee PER TEAM (NOT per player)</strong> to participate in the Ladder Tournament.
          </p>
          <p class="text-sm text-yellow-800 leading-relaxed mb-2">
            <strong>This means BDT 500 TOTAL for both players combined.</strong> You can split the cost between players or one player can pay the full amount.
          </p>
          <p class="text-sm text-yellow-800 leading-relaxed">
            After registration, you will receive payment instructions via email. Your team will be listed on the ladder rankings only after payment is confirmed.
          </p>
        </div>
      </div>
    </div>

    <div class="bg-gradient-to-r from-purple-50 to-indigo-50 border-l-4 border-purple-500 p-4 mb-4 rounded-r-lg">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"/>
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-semibold text-purple-900 mb-2">ðŸŽ¾ Ladder Tournament</h3>
          <p class="text-xs text-purple-800 leading-relaxed">
            Join our continuous ladder tournament where you can challenge teams above you and climb the rankings at your own pace. Play matches when it suits you, and participate in monthly Americano tournaments for extra fun!
          </p>
        </div>
      </div>
    </div>

    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-8 rounded-r-lg">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-semibold text-blue-800 mb-2">ðŸ”” Communication Preferences</h3>
          <ul class="text-xs text-blue-700 space-y-1">
            <li>â€¢ <strong>Email addresses are required</strong> for both players for match notifications</li>
            <li>â€¢ Choose how you want to be contacted: Email, WhatsApp, or both</li>
            <li>â€¢ WhatsApp numbers are needed if you select WhatsApp as a contact preference</li>
          </ul>
        </div>
      </div>
    </div>

    <form method="POST" class="space-y-8">
      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-2">Team Name *</label>
        <input
          type="text"
          name="team_name"
          required
          value="{{ form_data.get('team_name', '') if form_data else '' }}"
          class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none"
          placeholder="Enter your team name">
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-2">Ladder Category *</label>
        <select
          name="gender"
          required
          id="ladder-category"
          onchange="toggleMixedGenderFields()"
          class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none">
          <option value="">Select ladder category</option>
          <option value="men" {{ 'selected' if form_data and form_data.get('gender') == 'men' else '' }}>Men's Ladder</option>
          <option value="women" {{ 'selected' if form_data and form_data.get('gender') == 'women' else '' }}>Women's Ladder</option>
          <option value="mixed" {{ 'selected' if form_data and form_data.get('gender') == 'mixed' else '' }}>Mixed Ladder (1 Man + 1 Woman)</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-3">Contact Preferences * (Select at least one)</label>
        <div class="space-y-2">
          <label class="flex items-center">
            <input
              type="checkbox"
              name="contact_email"
              {{ 'checked' if form_data and form_data.get('contact_email') else 'checked' }}
              class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
            <span class="ml-2 text-sm text-gray-700">Email notifications</span>
          </label>
          <label class="flex items-center">
            <input
              type="checkbox"
              name="contact_whatsapp"
              {{ 'checked' if form_data and form_data.get('contact_whatsapp') else '' }}
              class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
            <span class="ml-2 text-sm text-gray-700">WhatsApp notifications</span>
          </label>
        </div>
      </div>

      <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl border-2 border-purple-200 p-6">
        <div class="mb-4">
          <h3 class="text-lg font-bold text-gray-900">Player 1 (Your Details)</h3>
        </div>
        <div class="grid grid-cols-1 gap-6">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Name *</label>
            <input
              type="text"
              name="player1_name"
              required
              value="{{ form_data.get('player1_name', '') if form_data else '' }}"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none"
              placeholder="Your full name">
          </div>
          <div id="player1-gender-field" style="display:none;">
            <label class="block text-sm font-semibold text-gray-700 mb-2">Player 1 Gender * (for Mixed teams)</label>
            <select
              name="player1_gender"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none">
              <option value="">Select gender</option>
              <option value="male" {{ 'selected' if form_data and form_data.get('player1_gender') == 'male' else '' }}>Male</option>
              <option value="female" {{ 'selected' if form_data and form_data.get('player1_gender') == 'female' else '' }}>Female</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Email *</label>
            <input
              type="email"
              name="player1_email"
              required
              value="{{ form_data.get('player1_email', '') if form_data else '' }}"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none"
              placeholder="player1@example.com">
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">WhatsApp Number *</label>
            <input
              type="tel"
              name="player1_phone"
              required
              value="{{ form_data.get('player1_phone', '') if form_data else '' }}"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none"
              placeholder="e.g., +8801712345678">
            <p class="text-xs text-gray-500 mt-1">Required for group chat and communications with admin</p>
          </div>
        </div>
      </div>

      <div class="bg-gradient-to-r from-pink-50 to-rose-50 rounded-xl border-2 border-pink-200 p-6">
        <div class="mb-4">
          <h3 class="text-lg font-bold text-gray-900">Player 2 (Partner's Details)</h3>
        </div>
        <div class="grid grid-cols-1 gap-6">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Name *</label>
            <input
              type="text"
              name="player2_name"
              required
              value="{{ form_data.get('player2_name', '') if form_data else '' }}"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none"
              placeholder="Partner's full name">
          </div>
          <div id="player2-gender-field" style="display:none;">
            <label class="block text-sm font-semibold text-gray-700 mb-2">Player 2 Gender * (for Mixed teams)</label>
            <select
              name="player2_gender"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none">
              <option value="">Select gender</option>
              <option value="male" {{ 'selected' if form_data and form_data.get('player2_gender') == 'male' else '' }}>Male</option>
              <option value="female" {{ 'selected' if form_data and form_data.get('player2_gender') == 'female' else '' }}>Female</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Email *</label>
            <input
              type="email"
              name="player2_email"
              required
              value="{{ form_data.get('player2_email', '') if form_data else '' }}"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none"
              placeholder="player2@example.com">
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">WhatsApp Number *</label>
            <input
              type="tel"
              name="player2_phone"
              required
              value="{{ form_data.get('player2_phone', '') if form_data else '' }}"
              class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition-all duration-200 outline-none"
              placeholder="e.g., +8801712345678">
            <p class="text-xs text-gray-500 mt-1">Required for group chat and communications with admin</p>
          </div>
        </div>
      </div>

      <!-- PAYMENT NOTICE - BOTTOM -->
      <div class="bg-yellow-50 border-2 border-yellow-400 p-6 rounded-lg">
        <div class="flex items-start mb-4">
          <svg class="h-6 w-6 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
          </svg>
          <div>
            <h3 class="text-sm font-bold text-yellow-900 mb-2">Payment Required to Complete Registration</h3>
            <p class="text-sm text-yellow-800 leading-relaxed">
              Registration fee: <strong>BDT 500 PER TEAM (NOT per player)</strong><br>
              This is BDT 500 TOTAL for both players - you can split the cost or one player can pay.<br>
              Payment details will be sent to your email after registration.
            </p>
          </div>
        </div>

        <label class="flex items-start cursor-pointer">
          <input
            type="checkbox"
            name="payment_agreement"
            required
            class="h-5 w-5 text-purple-600 focus:ring-purple-500 border-gray-300 rounded mt-0.5">
          <span class="ml-3 text-sm text-gray-900">
            <strong>I understand and agree to pay the BDT 500 registration fee PER TEAM (NOT per player).</strong> This is BDT 500 TOTAL for our entire team of 2 players. I acknowledge that my team will only be listed on the ladder rankings after payment is confirmed by the admin.
          </span>
        </label>
      </div>

      <button
        type="submit"
        class="w-full bg-gradient-to-r from-purple-600 to-indigo-700 text-white py-4 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
        Register Team for Ladder Tournament
      </button>
    </form>
  </div>
</div>

<script>
function toggleMixedGenderFields() {
  const category = document.getElementById('ladder-category').value;
  const player1GenderField = document.getElementById('player1-gender-field');
  const player2GenderField = document.getElementById('player2-gender-field');
  const player1GenderSelect = document.querySelector('select[name="player1_gender"]');
  const player2GenderSelect = document.querySelector('select[name="player2_gender"]');

  if (category === 'mixed') {
    player1GenderField.style.display = 'block';
    player2GenderField.style.display = 'block';
    player1GenderSelect.required = true;
    player2GenderSelect.required = true;
  } else {
    player1GenderField.style.display = 'none';
    player2GenderField.style.display = 'none';
    player1GenderSelect.required = false;
    player2GenderSelect.required = false;
  }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', toggleMixedGenderFields);
</script>
{% endblock %}